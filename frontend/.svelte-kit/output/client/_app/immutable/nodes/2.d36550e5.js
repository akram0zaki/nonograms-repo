import{s as ie,f as b,a as M,l as J,g as k,h as T,A as z,c as S,d as v,m as Y,j as _,B as et,i as L,x as m,C as Ee,D as W,E as O,y as G,F as ce,G as We,o as Xe,H as Z,I as X,n as oe,J as tt,e as _e,k as he,K as lt,L as Ne,M as nt,N as st,O as ge}from"../chunks/scheduler.3710c472.js";import{S as ue,i as fe,b as ee,d as te,m as le,t as F,c as Ze,a as K,e as ne,g as xe}from"../chunks/index.d77e5ae1.js";import{d as rt,w as Q}from"../chunks/paths.6b98bd4d.js";function H(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}const me="http://localhost:8000/api";async function ot(){try{const s=await fetch(`${me}/nonograms/list`);if(!s.ok)throw new Error(`API error: ${s.status} ${s.statusText}`);return(await s.json()).names}catch(s){throw console.error("Error fetching nonogram list:",s),s}}async function at(s){try{const e=await fetch(`${me}/nonograms/${encodeURIComponent(s)}`);if(!e.ok)throw new Error(`API error: ${e.status} ${e.statusText}`);return await e.json()}catch(e){throw console.error(`Error fetching nonogram '${s}':`,e),e}}async function it(s){try{const e=await fetch(`${me}/nonograms/search?clue=${encodeURIComponent(s)}`);if(!e.ok)throw new Error(`API error: ${e.status} ${e.statusText}`);return(await e.json()).matches}catch(e){throw console.error(`Error searching nonograms with clue '${s}':`,e),e}}async function ct(s){try{const e=await fetch(`${me}/nonograms/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok)throw new Error(`API error: ${e.status} ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error creating nonogram:",e),e}}const ae=Q(null),De=Q([]),be=Q([]),x=Q("view"),re=Q(!1),ut=Q(5),ft=Q(5),ke=Q([]),ve=Q([]),j=Q(""),dt=rt([ae,ve],([s,e])=>{if(!s||!e.length)return!1;const{board:l}=s;for(let t=0;t<l.length;t++)for(let n=0;n<l[t].length;n++)if(l[t][n]&&e[t][n]!=="filled"||!l[t][n]&&e[t][n]==="filled")return!1;return!0});function ht(s){const e=s.board.length,l=s.board[0].length,t=Array(e).fill(null).map(()=>Array(l).fill("empty"));ve.set(t)}function _t(s,e){const l=Array(s).fill(null).map(()=>Array(e).fill(!1));ke.set(l)}function gt(s,e,l=!1){ve.update(t=>{const n=[...t];return n[s]=[...n[s]],l?n[s][e]=n[s][e]==="empty"?"marked":"empty":n[s][e]=n[s][e]==="empty"?"filled":"empty",n})}function mt(s,e){ke.update(l=>{const t=[...l];return t[s]=[...t[s]],t[s][e]=!t[s][e],t}),re.set(!0)}function Te(s){if(!s.length||!s[0].length)return{rows:[],columns:[]};const e=s.length,l=s[0].length,t=s.map(r=>{const o=[];let a=0;for(let i=0;i<r.length;i++)r[i]?a++:a>0&&(o.push(a),a=0);return a>0&&o.push(a),o.length===0&&o.push(0),o}),n=[];for(let r=0;r<l;r++){const o=[];let a=0;for(let i=0;i<e;i++)s[i][r]?a++:a>0&&(o.push(a),a=0);a>0&&o.push(a),o.length===0&&o.push(0),n.push(o)}return{rows:t,columns:n}}function Ie(s,e,l){const t=s.slice();return t[16]=e[l],t}function $e(s,e,l){const t=s.slice();return t[16]=e[l],t}function vt(s){let e,l=H(s[3]),t=[];for(let n=0;n<l.length;n+=1)t[n]=Ve($e(s,l,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=_e()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);e=_e()},m(n,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,r);L(n,e,r)},p(n,r){if(r&8){l=H(n[3]);let o;for(o=0;o<l.length;o+=1){const a=$e(n,l,o);t[o]?t[o].p(a,r):(t[o]=Ve(a),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(n){n&&v(e),Z(t,n)}}}function pt(s){let e,l="No nonograms available";return{c(){e=b("option"),e.textContent=l,this.h()},l(t){e=k(t,"OPTION",{"data-svelte-h":!0}),z(e)!=="svelte-1ou2syi"&&(e.textContent=l),this.h()},h(){e.__value="",W(e,e.__value)},m(t,n){L(t,e,n)},p:G,d(t){t&&v(e)}}}function Ve(s){let e,l=s[16]+"",t,n;return{c(){e=b("option"),t=J(l),this.h()},l(r){e=k(r,"OPTION",{});var o=T(e);t=Y(o,l),o.forEach(v),this.h()},h(){e.__value=n=s[16],W(e,e.__value)},m(r,o){L(r,e,o),m(e,t)},p(r,o){o&8&&l!==(l=r[16]+"")&&oe(t,l),o&8&&n!==(n=r[16])&&(e.__value=n,W(e,e.__value))},d(r){r&&v(e)}}}function Me(s){let e,l,t="Search Results:",n,r,o=H(s[4]),a=[];for(let i=0;i<o.length;i+=1)a[i]=Se(Ie(s,o,i));return{c(){e=b("div"),l=b("h4"),l.textContent=t,n=M(),r=b("ul");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){e=k(i,"DIV",{class:!0});var h=T(e);l=k(h,"H4",{id:!0,class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1jg0gl6"&&(l.textContent=t),n=S(h),r=k(h,"UL",{role:!0,"aria-labelledby":!0,class:!0});var c=T(r);for(let f=0;f<a.length;f+=1)a[f].l(c);c.forEach(v),h.forEach(v),this.h()},h(){_(l,"id","search-results-heading"),_(l,"class","svelte-1x70pkp"),_(r,"role","listbox"),_(r,"aria-labelledby","search-results-heading"),_(r,"class","svelte-1x70pkp"),_(e,"class","search-results svelte-1x70pkp")},m(i,h){L(i,e,h),m(e,l),m(e,n),m(e,r);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(r,null)},p(i,h){if(h&785){o=H(i[4]);let c;for(c=0;c<o.length;c+=1){const f=Ie(i,o,c);a[c]?a[c].p(f,h):(a[c]=Se(f),a[c].c(),a[c].m(r,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=o.length}},d(i){i&&v(e),Z(a,i)}}}function Se(s){let e,l=s[16]+"",t,n,r,o,a;function i(){return s[12](s[16])}function h(...c){return s[13](s[16],...c)}return{c(){e=b("li"),t=J(l),n=M(),this.h()},l(c){e=k(c,"LI",{role:!0,"aria-selected":!0,tabindex:!0,class:!0});var f=T(e);t=Y(f,l),n=S(f),f.forEach(v),this.h()},h(){_(e,"role","option"),_(e,"aria-selected",r=s[0]===s[16]),_(e,"tabindex","0"),_(e,"class","svelte-1x70pkp"),X(e,"selected",s[0]===s[16])},m(c,f){L(c,e,f),m(e,t),m(e,n),o||(a=[O(e,"click",i),O(e,"keydown",h)],o=!0)},p(c,f){s=c,f&16&&l!==(l=s[16]+"")&&oe(t,l),f&25&&r!==(r=s[0]===s[16])&&_(e,"aria-selected",r),f&17&&X(e,"selected",s[0]===s[16])},d(c){c&&v(e),o=!1,ce(a)}}}function bt(s){let e,l,t,n="Load:",r,o,a,i,h,c,f,g,u,w,C="Search by Clues:",R,E,D,d,p,y,V="New Puzzle",P,A;function U(I,B){return I[3].length===0?pt:vt}let N=U(s),q=N(s),$=s[4].length>0&&Me(s);return{c(){e=b("div"),l=b("div"),t=b("label"),t.textContent=n,r=M(),o=b("select"),q.c(),i=M(),h=b("button"),c=J("Load Selected"),g=M(),u=b("div"),w=b("label"),w.textContent=C,R=M(),E=b("input"),D=M(),$&&$.c(),d=M(),p=b("div"),y=b("button"),y.textContent=V,this.h()},l(I){e=k(I,"DIV",{class:!0});var B=T(e);l=k(B,"DIV",{class:!0});var se=T(l);t=k(se,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(t)!=="svelte-dn6dk6"&&(t.textContent=n),r=S(se),o=k(se,"SELECT",{id:!0,class:!0});var we=T(o);q.l(we),we.forEach(v),i=S(se),h=k(se,"BUTTON",{class:!0});var Ce=T(h);c=Y(Ce,"Load Selected"),Ce.forEach(v),se.forEach(v),g=S(B),u=k(B,"DIV",{class:!0});var de=T(u);w=k(de,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(w)!=="svelte-1flsu2w"&&(w.textContent=C),R=S(de),E=k(de,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),de.forEach(v),D=S(B),$&&$.l(B),d=S(B),p=k(B,"DIV",{class:!0});var ye=T(p);y=k(ye,"BUTTON",{class:!0,"data-svelte-h":!0}),z(y)!=="svelte-y5fk5w"&&(y.textContent=V),ye.forEach(v),B.forEach(v),this.h()},h(){_(t,"for","nonogram-select"),_(t,"class","svelte-1x70pkp"),_(o,"id","nonogram-select"),o.disabled=a=s[3].length===0,_(o,"class","svelte-1x70pkp"),s[0]===void 0&&et(()=>s[10].call(o)),h.disabled=f=!s[0],_(h,"class","svelte-1x70pkp"),_(l,"class","selector-row svelte-1x70pkp"),_(w,"for","search-input"),_(w,"class","svelte-1x70pkp"),_(E,"id","search-input"),_(E,"type","text"),_(E,"placeholder","Enter clue (e.g., '1,2,3' or '1 2 3')"),E.disabled=s[2],_(E,"class","svelte-1x70pkp"),_(u,"class","selector-row svelte-1x70pkp"),_(y,"class","svelte-1x70pkp"),_(p,"class","selector-row svelte-1x70pkp"),_(e,"class","selector-container svelte-1x70pkp")},m(I,B){L(I,e,B),m(e,l),m(l,t),m(l,r),m(l,o),q.m(o,null),Ee(o,s[0],!0),m(l,i),m(l,h),m(h,c),m(e,g),m(e,u),m(u,w),m(u,R),m(u,E),W(E,s[1]),m(e,D),$&&$.m(e,null),m(e,d),m(e,p),m(p,y),P||(A=[O(o,"change",s[10]),O(h,"click",s[5]),O(E,"input",s[11]),O(E,"input",s[6]),O(y,"click",s[7])],P=!0)},p(I,[B]){N===(N=U(I))&&q?q.p(I,B):(q.d(1),q=N(I),q&&(q.c(),q.m(o,null))),B&8&&a!==(a=I[3].length===0)&&(o.disabled=a),B&9&&Ee(o,I[0]),B&9&&f!==(f=!I[0])&&(h.disabled=f),B&4&&(E.disabled=I[2]),B&2&&E.value!==I[1]&&W(E,I[1]),I[4].length>0?$?$.p(I,B):($=Me(I),$.c(),$.m(e,d)):$&&($.d(1),$=null)},i:G,o:G,d(I){I&&v(e),q.d(),$&&$.d(),P=!1,ce(A)}}}function kt(s,e,l){const t=We();let n="",r="",o=!1,a=null,i=[],h=[];De.subscribe(d=>l(3,i=d)),be.subscribe(d=>l(4,h=d)),Xe(async()=>{try{j.set("Loading nonogram list...");const d=await ot();De.set(d),d.length>0&&l(0,n=d[0]),j.set("")}catch(d){console.error("Error fetching nonogram list:",d),j.set("Error loading nonogram list. Please try again later.")}});function c(){n&&t("select",n)}function f(){a&&clearTimeout(a),a=setTimeout(async()=>{if(r.trim().length>0)try{l(2,o=!0),j.set("Searching...");const d=await it(r);be.set(d),d.length>0?(l(0,n=d[0]),j.set(`Found ${d.length} matching nonogram(s)`)):j.set("No matches found")}catch(d){console.error("Error searching nonograms:",d),j.set("Error during search. Please try again.")}finally{l(2,o=!1)}else be.set([]),j.set("")},500)}function g(){t("new")}function u(d){l(0,n=d)}function w(d,p){(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),l(0,n=p))}function C(){n=tt(this),l(0,n),l(3,i)}function R(){r=this.value,l(1,r)}return[n,r,o,i,h,c,f,g,u,w,C,R,d=>u(d),(d,p)=>w(p,d)]}class wt extends ue{constructor(e){super(),fe(this,e,kt,bt,ie,{})}}function Le(s,e,l){const t=s.slice();return t[16]=e[l],t[18]=l,t}function Pe(s,e,l){const t=s.slice();return t[19]=e[l],t[21]=l,t}function Ae(s){let e,l="Ã—";return{c(){e=b("span"),e.textContent=l,this.h()},l(t){e=k(t,"SPAN",{"aria-hidden":!0,class:!0,"data-svelte-h":!0}),z(e)!=="svelte-wjzu5c"&&(e.textContent=l),this.h()},h(){_(e,"aria-hidden","true"),_(e,"class","svelte-2gupkd")},m(t,n){L(t,e,n)},d(t){t&&v(e)}}}function Be(s){let e,l,t,n,r,o,a=s[1]==="play"&&s[19]==="marked"&&Ae();function i(...g){return s[10](s[18],s[21],...g)}function h(){return s[11](s[18],s[21])}function c(){return s[12](s[18],s[21])}function f(...g){return s[13](s[18],s[21],...g)}return{c(){e=b("button"),a&&a.c(),l=M(),this.h()},l(g){e=k(g,"BUTTON",{type:!0,class:!0,"aria-label":!0,"aria-pressed":!0});var u=T(e);a&&a.l(u),l=S(u),u.forEach(v),this.h()},h(){_(e,"type","button"),_(e,"class",t=Ne(s[8](s[19],s[18],s[21]))+" svelte-2gupkd"),_(e,"aria-label","Cell row "+(s[18]+1)+", column "+(s[21]+1)),_(e,"aria-pressed",n=s[19]===!0||s[19]==="filled")},m(g,u){L(g,e,u),a&&a.m(e,null),m(e,l),r||(o=[O(e,"mousedown",i),O(e,"mouseover",h),O(e,"mouseup",s[5]),O(e,"mouseleave",s[5]),O(e,"contextmenu",nt(s[9])),O(e,"focus",c),O(e,"keydown",f)],r=!0)},p(g,u){s=g,s[1]==="play"&&s[19]==="marked"?a||(a=Ae(),a.c(),a.m(e,l)):a&&(a.d(1),a=null),u&1&&t!==(t=Ne(s[8](s[19],s[18],s[21]))+" svelte-2gupkd")&&_(e,"class",t),u&1&&n!==(n=s[19]===!0||s[19]==="filled")&&_(e,"aria-pressed",n)},d(g){g&&v(e),a&&a.d(),r=!1,ce(o)}}}function qe(s){let e,l=H(s[16]),t=[];for(let n=0;n<l.length;n+=1)t[n]=Be(Pe(s,l,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=_e()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);e=_e()},m(n,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,r);L(n,e,r)},p(n,r){if(r&499){l=H(n[16]);let o;for(o=0;o<l.length;o+=1){const a=Pe(n,l,o);t[o]?t[o].p(a,r):(t[o]=Be(a),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(n){n&&v(e),Z(t,n)}}}function Ct(s){let e,l,t=H(s[0]),n=[];for(let r=0;r<t.length;r+=1)n[r]=qe(Le(s,t,r));return{c(){e=b("div"),l=b("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var o=T(e);l=k(o,"DIV",{class:!0,style:!0});var a=T(l);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(v),o.forEach(v),this.h()},h(){_(l,"class","grid svelte-2gupkd"),he(l,"grid-template-columns","repeat("+s[2]+", 25px)"),he(l,"grid-template-rows","repeat("+s[3]+", 25px)"),_(e,"class","grid-container svelte-2gupkd")},m(r,o){L(r,e,o),m(e,l);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(l,null)},p(r,[o]){if(o&499){t=H(r[0]);let a;for(a=0;a<t.length;a+=1){const i=Le(r,t,a);n[a]?n[a].p(i,o):(n[a]=qe(i),n[a].c(),n[a].m(l,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}o&4&&he(l,"grid-template-columns","repeat("+r[2]+", 25px)"),o&8&&he(l,"grid-template-rows","repeat("+r[3]+", 25px)")},i:G,o:G,d(r){r&&v(e),Z(n,r)}}}function yt(s,e,l){let t,n,{board:r=[]}=e,{mode:o="view"}=e;const a=We();let i={isMouseDown:!1,isRightMouseDown:!1,lastCellToggled:null};function h(d,p,y){y.preventDefault(),(o==="play"||o==="edit"||o==="create")&&(y.button===2?(i.isRightMouseDown=!0,i.isMouseDown=!1,i.lastCellToggled={row:d,col:p},a("cellToggle",{row:d,col:p,isRightClick:!0})):(i.isMouseDown=!0,i.isRightMouseDown=!1,i.lastCellToggled={row:d,col:p},a("cellToggle",{row:d,col:p,isRightClick:!1})))}function c(){i.isMouseDown=!1,i.isRightMouseDown=!1,i.lastCellToggled=null}function f(d,p){(i.isMouseDown||i.isRightMouseDown)&&(o==="play"||o==="edit"||o==="create")&&i.lastCellToggled&&(i.lastCellToggled.row!==d||i.lastCellToggled.col!==p)&&(i.lastCellToggled={row:d,col:p},a("cellToggle",{row:d,col:p,isRightClick:i.isRightMouseDown}))}function g(d,p,y){(o==="play"||o==="edit"||o==="create")&&(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),a("cellToggle",{row:d,col:p,isRightClick:y.shiftKey}))}function u(d,p,y){let V="cell";return(p+1)%5===0&&p<t-1&&(V+=" border-bottom"),(y+1)%5===0&&y<n-1&&(V+=" border-right"),o==="view"?(d===!0||d==="filled")&&(V+=" filled"):o==="edit"||o==="create"?d===!0&&(V+=" filled"):o==="play"&&(d==="filled"?V+=" filled":d==="marked"&&(V+=" marked")),V}function w(d){lt.call(this,s,d)}const C=(d,p,y)=>h(d,p,y),R=(d,p)=>f(d,p),E=(d,p)=>void 0,D=(d,p,y)=>g(d,p,y);return s.$$set=d=>{"board"in d&&l(0,r=d.board),"mode"in d&&l(1,o=d.mode)},s.$$.update=()=>{s.$$.dirty&1&&l(3,t=r.length),s.$$.dirty&1&&l(2,n=r.length>0?r[0].length:0)},[r,o,n,t,h,c,f,g,u,w,C,R,E,D]}class pe extends ue{constructor(e){super(),fe(this,e,yt,Ct,ie,{board:0,mode:1})}}function Re(s,e,l){const t=s.slice();return t[4]=e[l],t}function Oe(s,e,l){const t=s.slice();return t[7]=e[l],t[9]=l,t}function Ue(s,e,l){const t=s.slice();return t[7]=e[l],t[9]=l,t}function ze(s,e,l){const t=s.slice();return t[11]=e[l],t}function je(s){let e=s[11][s[9]-(s[2]-s[11].length)]+"",l;return{c(){l=J(e)},l(t){l=Y(t,e)},m(t,n){L(t,l,n)},p(t,n){n&6&&e!==(e=t[11][t[9]-(t[2]-t[11].length)]+"")&&oe(l,e)},d(t){t&&v(l)}}}function He(s){let e,l=s[9]>=s[2]-s[11].length&&je(s);return{c(){e=b("div"),l&&l.c(),this.h()},l(t){e=k(t,"DIV",{class:!0});var n=T(e);l&&l.l(n),n.forEach(v),this.h()},h(){_(e,"class","clue-cell svelte-1v0l4l")},m(t,n){L(t,e,n),l&&l.m(e,null)},p(t,n){t[9]>=t[2]-t[11].length?l?l.p(t,n):(l=je(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(t){t&&v(e),l&&l.d()}}}function Ge(s){let e,l,t=H(s[1]),n=[];for(let r=0;r<t.length;r+=1)n[r]=He(ze(s,t,r));return{c(){e=b("div");for(let r=0;r<n.length;r+=1)n[r].c();l=M(),this.h()},l(r){e=k(r,"DIV",{class:!0});var o=T(e);for(let a=0;a<n.length;a+=1)n[a].l(o);l=S(o),o.forEach(v),this.h()},h(){_(e,"class","column-clue-row svelte-1v0l4l")},m(r,o){L(r,e,o);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null);m(e,l)},p(r,o){if(o&6){t=H(r[1]);let a;for(a=0;a<t.length;a+=1){const i=ze(r,t,a);n[a]?n[a].p(i,o):(n[a]=He(i),n[a].c(),n[a].m(e,l))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(r){r&&v(e),Z(n,r)}}}function Fe(s){let e=s[4][s[9]-(s[3]-s[4].length)]+"",l;return{c(){l=J(e)},l(t){l=Y(t,e)},m(t,n){L(t,l,n)},p(t,n){n&9&&e!==(e=t[4][t[9]-(t[3]-t[4].length)]+"")&&oe(l,e)},d(t){t&&v(l)}}}function Ke(s){let e,l=s[9]>=s[3]-s[4].length&&Fe(s);return{c(){e=b("div"),l&&l.c(),this.h()},l(t){e=k(t,"DIV",{class:!0});var n=T(e);l&&l.l(n),n.forEach(v),this.h()},h(){_(e,"class","clue-cell svelte-1v0l4l")},m(t,n){L(t,e,n),l&&l.m(e,null)},p(t,n){t[9]>=t[3]-t[4].length?l?l.p(t,n):(l=Fe(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(t){t&&v(e),l&&l.d()}}}function Je(s){let e,l,t=H(Array(s[3])),n=[];for(let r=0;r<t.length;r+=1)n[r]=Ke(Oe(s,t,r));return{c(){e=b("div");for(let r=0;r<n.length;r+=1)n[r].c();l=M(),this.h()},l(r){e=k(r,"DIV",{class:!0});var o=T(e);for(let a=0;a<n.length;a+=1)n[a].l(o);l=S(o),o.forEach(v),this.h()},h(){_(e,"class","row-clue svelte-1v0l4l")},m(r,o){L(r,e,o);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null);m(e,l)},p(r,o){if(o&9){t=H(Array(r[3]));let a;for(a=0;a<t.length;a+=1){const i=Oe(r,t,a);n[a]?n[a].p(i,o):(n[a]=Ke(i),n[a].c(),n[a].m(e,l))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(r){r&&v(e),Z(n,r)}}}function Et(s){let e,l,t,n,r,o,a=H(Array(s[2])),i=[];for(let f=0;f<a.length;f+=1)i[f]=Ge(Ue(s,a,f));let h=H(s[0]),c=[];for(let f=0;f<h.length;f+=1)c[f]=Je(Re(s,h,f));return{c(){e=b("div"),l=b("div"),t=M(),n=b("div");for(let f=0;f<i.length;f+=1)i[f].c();r=M(),o=b("div");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=k(f,"DIV",{class:!0});var g=T(e);l=k(g,"DIV",{class:!0}),T(l).forEach(v),t=S(g),n=k(g,"DIV",{class:!0});var u=T(n);for(let C=0;C<i.length;C+=1)i[C].l(u);u.forEach(v),r=S(g),o=k(g,"DIV",{class:!0});var w=T(o);for(let C=0;C<c.length;C+=1)c[C].l(w);w.forEach(v),g.forEach(v),this.h()},h(){_(l,"class","top-left-corner svelte-1v0l4l"),_(n,"class","column-clues svelte-1v0l4l"),_(o,"class","row-clues svelte-1v0l4l"),_(e,"class","clues-container svelte-1v0l4l")},m(f,g){L(f,e,g),m(e,l),m(e,t),m(e,n);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(n,null);m(e,r),m(e,o);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(o,null)},p(f,[g]){if(g&6){a=H(Array(f[2]));let u;for(u=0;u<a.length;u+=1){const w=Ue(f,a,u);i[u]?i[u].p(w,g):(i[u]=Ge(w),i[u].c(),i[u].m(n,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=a.length}if(g&9){h=H(f[0]);let u;for(u=0;u<h.length;u+=1){const w=Re(f,h,u);c[u]?c[u].p(w,g):(c[u]=Je(w),c[u].c(),c[u].m(o,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=h.length}},i:G,o:G,d(f){f&&v(e),Z(i,f),Z(c,f)}}}function Nt(s,e,l){let t,n,{rowClues:r=[]}=e,{colClues:o=[]}=e;return s.$$set=a=>{"rowClues"in a&&l(0,r=a.rowClues),"colClues"in a&&l(1,o=a.colClues)},s.$$.update=()=>{s.$$.dirty&1&&l(3,t=Math.max(...r.map(a=>a.length),0)),s.$$.dirty&2&&l(2,n=Math.max(...o.map(a=>a.length),0))},[r,o,n,t]}class Dt extends ue{constructor(e){super(),fe(this,e,Nt,Et,ie,{rowClues:0,colClues:1})}}function Tt(s){let e;function l(r,o){return r[0]?Mt:Vt}let t=l(s),n=t(s);return{c(){e=b("div"),n.c(),this.h()},l(r){e=k(r,"DIV",{class:!0});var o=T(e);n.l(o),o.forEach(v),this.h()},h(){_(e,"class","current-nonogram")},m(r,o){L(r,e,o),n.m(e,null)},p(r,o){t===(t=l(r))&&n?n.p(r,o):(n.d(1),n=t(r),n&&(n.c(),n.m(e,null)))},d(r){r&&v(e),n.d()}}}function It(s){let e,l;return{c(){e=b("div"),l=J(s[2]),this.h()},l(t){e=k(t,"DIV",{class:!0});var n=T(e);l=Y(n,s[2]),n.forEach(v),this.h()},h(){_(e,"class","info-message svelte-12xk65x")},m(t,n){L(t,e,n),m(e,l)},p(t,n){n&4&&oe(l,t[2])},d(t){t&&v(e)}}}function $t(s){let e,l="ðŸŽ‰ Puzzle Solved! Congratulations! ðŸŽ‰";return{c(){e=b("div"),e.textContent=l,this.h()},l(t){e=k(t,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1muy2iw"&&(e.textContent=l),this.h()},h(){_(e,"class","success-message svelte-12xk65x")},m(t,n){L(t,e,n)},p:G,d(t){t&&v(e)}}}function Vt(s){let e;return{c(){e=J("No nonogram loaded")},l(l){e=Y(l,"No nonogram loaded")},m(l,t){L(l,e,t)},p:G,d(l){l&&v(e)}}}function Mt(s){let e,l,t;return{c(){e=J("Current: "),l=b("span"),t=J(s[0]),this.h()},l(n){e=Y(n,"Current: "),l=k(n,"SPAN",{class:!0});var r=T(l);t=Y(r,s[0]),r.forEach(v),this.h()},h(){_(l,"class","nonogram-name svelte-12xk65x")},m(n,r){L(n,e,r),L(n,l,r),m(l,t)},p(n,r){r&1&&oe(t,n[0])},d(n){n&&(v(e),v(l))}}}function St(s){let e,l,t,n,r,o="Mode:",a,i,h,c,f,g,u,w,C,R,E,D="Create",d,p;function y(A,U){return A[3]?$t:A[2]?It:Tt}let V=y(s),P=V(s);return{c(){e=b("div"),l=b("div"),P.c(),t=M(),n=b("div"),r=b("div"),r.textContent=o,a=M(),i=b("div"),h=b("button"),c=J("Play"),g=M(),u=b("button"),w=J("Edit"),R=M(),E=b("button"),E.textContent=D,this.h()},l(A){e=k(A,"DIV",{class:!0});var U=T(e);l=k(U,"DIV",{class:!0});var N=T(l);P.l(N),N.forEach(v),t=S(U),n=k(U,"DIV",{class:!0});var q=T(n);r=k(q,"DIV",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-8qisys"&&(r.textContent=o),a=S(q),i=k(q,"DIV",{class:!0});var $=T(i);h=k($,"BUTTON",{class:!0});var I=T(h);c=Y(I,"Play"),I.forEach(v),g=S($),u=k($,"BUTTON",{class:!0});var B=T(u);w=Y(B,"Edit"),B.forEach(v),R=S($),E=k($,"BUTTON",{class:!0,"data-svelte-h":!0}),z(E)!=="svelte-k5o5tv"&&(E.textContent=D),$.forEach(v),q.forEach(v),U.forEach(v),this.h()},h(){_(l,"class","status-message svelte-12xk65x"),_(r,"class","mode-label svelte-12xk65x"),h.disabled=f=!s[0],_(h,"class","svelte-12xk65x"),X(h,"active",s[1]==="play"),u.disabled=C=!s[0],_(u,"class","svelte-12xk65x"),X(u,"active",s[1]==="edit"),_(E,"class","svelte-12xk65x"),X(E,"active",s[1]==="create"),_(i,"class","mode-buttons svelte-12xk65x"),_(n,"class","mode-selector svelte-12xk65x"),_(e,"class","status-bar svelte-12xk65x")},m(A,U){L(A,e,U),m(e,l),P.m(l,null),m(e,t),m(e,n),m(n,r),m(n,a),m(n,i),m(i,h),m(h,c),m(i,g),m(i,u),m(u,w),m(i,R),m(i,E),d||(p=[O(h,"click",s[5]),O(u,"click",s[6]),O(E,"click",s[7])],d=!0)},p(A,[U]){V===(V=y(A))&&P?P.p(A,U):(P.d(1),P=V(A),P&&(P.c(),P.m(l,null))),U&1&&f!==(f=!A[0])&&(h.disabled=f),U&2&&X(h,"active",A[1]==="play"),U&1&&C!==(C=!A[0])&&(u.disabled=C),U&2&&X(u,"active",A[1]==="edit"),U&2&&X(E,"active",A[1]==="create")},i:G,o:G,d(A){A&&v(e),P.d(),d=!1,ce(p)}}}function Lt(s,e,l){let{currentNonogramName:t=""}=e,n,r,o;x.subscribe(f=>l(1,n=f)),j.subscribe(f=>l(2,r=f)),dt.subscribe(f=>l(3,o=f));function a(f){x.set(f)}const i=()=>a("play"),h=()=>a("edit"),c=()=>a("create");return s.$$set=f=>{"currentNonogramName"in f&&l(0,t=f.currentNonogramName)},[t,n,r,o,a,i,h,c]}class Pt extends ue{constructor(e){super(),fe(this,e,Lt,St,ie,{currentNonogramName:0})}}function Ye(s){let e,l,t="Create New Nonogram",n,r,o,a="Rows:",i,h,c,f,g,u="Columns:",w,C,R,E,D="Create Grid",d,p;return{c(){e=b("div"),l=b("h3"),l.textContent=t,n=M(),r=b("div"),o=b("label"),o.textContent=a,i=M(),h=b("input"),c=M(),f=b("div"),g=b("label"),g.textContent=u,w=M(),C=b("input"),R=M(),E=b("button"),E.textContent=D,this.h()},l(y){e=k(y,"DIV",{class:!0});var V=T(e);l=k(V,"H3",{"data-svelte-h":!0}),z(l)!=="svelte-lxn9d1"&&(l.textContent=t),n=S(V),r=k(V,"DIV",{class:!0});var P=T(r);o=k(P,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1v5jt2k"&&(o.textContent=a),i=S(P),h=k(P,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),P.forEach(v),c=S(V),f=k(V,"DIV",{class:!0});var A=T(f);g=k(A,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(g)!=="svelte-dfylde"&&(g.textContent=u),w=S(A),C=k(A,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),A.forEach(v),R=S(V),E=k(V,"BUTTON",{"data-svelte-h":!0}),z(E)!=="svelte-3miy8g"&&(E.textContent=D),V.forEach(v),this.h()},h(){_(o,"for","rows"),_(o,"class","svelte-1d5q74c"),_(h,"id","rows"),_(h,"type","number"),_(h,"min","3"),_(h,"max","20"),_(h,"class","svelte-1d5q74c"),_(r,"class","form-row svelte-1d5q74c"),_(g,"for","cols"),_(g,"class","svelte-1d5q74c"),_(C,"id","cols"),_(C,"type","number"),_(C,"min","3"),_(C,"max","20"),_(C,"class","svelte-1d5q74c"),_(f,"class","form-row svelte-1d5q74c"),_(e,"class","create-form svelte-1d5q74c")},m(y,V){L(y,e,V),m(e,l),m(e,n),m(e,r),m(r,o),m(r,i),m(r,h),W(h,s[5]),m(e,c),m(e,f),m(f,g),m(f,w),m(f,C),W(C,s[6]),m(e,R),m(e,E),d||(p=[O(h,"input",s[13]),O(C,"input",s[14]),O(E,"click",s[11])],d=!0)},p(y,V){V&32&&ge(h.value)!==y[5]&&W(h,y[5]),V&64&&ge(C.value)!==y[6]&&W(C,y[6])},d(y){y&&v(e),d=!1,ce(p)}}}function Qe(s){let e,l,t="Process Nonogram",n,r,o="Note: In v1.0, nonograms are not saved to the backend.",a,i;return{c(){e=b("div"),l=b("button"),l.textContent=t,n=M(),r=b("p"),r.textContent=o,this.h()},l(h){e=k(h,"DIV",{class:!0});var c=T(e);l=k(c,"BUTTON",{"data-svelte-h":!0}),z(l)!=="svelte-1b8xo17"&&(l.textContent=t),n=S(c),r=k(c,"P",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-wqxq8l"&&(r.textContent=o),c.forEach(v),this.h()},h(){_(r,"class","note svelte-1d5q74c"),_(e,"class","edit-actions svelte-1d5q74c")},m(h,c){L(h,e,c),m(e,l),m(e,n),m(e,r),a||(i=O(l,"click",s[12]),a=!0)},p:G,d(h){h&&v(e),a=!1,i()}}}function At(s){let e,l="<p>Loading...</p>";return{c(){e=b("div"),e.innerHTML=l,this.h()},l(t){e=k(t,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-sq2l2"&&(e.innerHTML=l),this.h()},h(){_(e,"class","loading svelte-1d5q74c")},m(t,n){L(t,e,n)},p:G,i:G,o:G,d(t){t&&v(e)}}}function Bt(s){let e,l,t,n,r,o,a,i;t=new Dt({props:{rowClues:s[7].rows,colClues:s[7].columns}});const h=[Ut,Ot,Rt,qt],c=[];function f(g,u){return g[2]==="play"?0:g[2]==="edit"?1:g[2]==="create"&&g[1].length>0?2:g[2]==="view"&&g[0]?3:-1}return~(o=f(s))&&(a=c[o]=h[o](s)),{c(){e=b("div"),l=b("div"),ee(t.$$.fragment),n=M(),r=b("div"),a&&a.c(),this.h()},l(g){e=k(g,"DIV",{class:!0});var u=T(e);l=k(u,"DIV",{class:!0});var w=T(l);te(t.$$.fragment,w),n=S(w),r=k(w,"DIV",{class:!0});var C=T(r);a&&a.l(C),C.forEach(v),w.forEach(v),u.forEach(v),this.h()},h(){_(r,"class","grid-area svelte-1d5q74c"),_(l,"class","nonogram-container svelte-1d5q74c"),_(e,"class","nonogram-area svelte-1d5q74c")},m(g,u){L(g,e,u),m(e,l),le(t,l,null),m(l,n),m(l,r),~o&&c[o].m(r,null),i=!0},p(g,u){const w={};u&128&&(w.rowClues=g[7].rows),u&128&&(w.colClues=g[7].columns),t.$set(w);let C=o;o=f(g),o===C?~o&&c[o].p(g,u):(a&&(xe(),F(c[C],1,1,()=>{c[C]=null}),Ze()),~o?(a=c[o],a?a.p(g,u):(a=c[o]=h[o](g),a.c()),K(a,1),a.m(r,null)):a=null)},i(g){i||(K(t.$$.fragment,g),K(a),i=!0)},o(g){F(t.$$.fragment,g),F(a),i=!1},d(g){g&&v(e),ne(t),~o&&c[o].d()}}}function qt(s){let e,l;return e=new pe({props:{board:s[0].board,mode:"view"}}),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,n){le(e,t,n),l=!0},p(t,n){const r={};n&1&&(r.board=t[0].board),e.$set(r)},i(t){l||(K(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function Rt(s){let e,l;return e=new pe({props:{board:s[1],mode:"create"}}),e.$on("cellToggle",s[10]),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,n){le(e,t,n),l=!0},p(t,n){const r={};n&2&&(r.board=t[1]),e.$set(r)},i(t){l||(K(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function Ot(s){let e,l;return e=new pe({props:{board:s[1],mode:s[2]}}),e.$on("cellToggle",s[10]),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,n){le(e,t,n),l=!0},p(t,n){const r={};n&2&&(r.board=t[1]),n&4&&(r.mode=t[2]),e.$set(r)},i(t){l||(K(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function Ut(s){let e,l;return e=new pe({props:{board:s[3],mode:s[2]}}),e.$on("cellToggle",s[10]),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,n){le(e,t,n),l=!0},p(t,n){const r={};n&8&&(r.board=t[3]),n&4&&(r.mode=t[2]),e.$set(r)},i(t){l||(K(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function zt(s){var U;let e,l,t,n='<h1 class="svelte-1d5q74c">Nonogram SPA Editor</h1>',r,o,a,i,h,c,f,g,u,w,C,R,E,D="<p>Â© 2025 Nonogram Editor - Version 1.0</p>",d;a=new Pt({props:{currentNonogramName:((U=s[0])==null?void 0:U.name)||""}}),c=new wt({}),c.$on("select",s[8]),c.$on("new",s[9]);let p=s[2]==="create"&&!s[1].length&&Ye(s),y=(s[2]==="edit"||s[2]==="create"&&s[1].length>0)&&s[4]&&Qe(s);const V=[Bt,At],P=[];function A(N,q){return(N[0]||N[2]==="create"&&N[1].length>0)&&N[2]!=="loading"?0:N[2]==="loading"?1:-1}return~(w=A(s))&&(C=P[w]=V[w](s)),{c(){e=M(),l=b("div"),t=b("header"),t.innerHTML=n,r=M(),o=b("main"),ee(a.$$.fragment),i=M(),h=b("div"),ee(c.$$.fragment),f=M(),p&&p.c(),g=M(),y&&y.c(),u=M(),C&&C.c(),R=M(),E=b("footer"),E.innerHTML=D,this.h()},l(N){st("svelte-6iyx7p",document.head).forEach(v),e=S(N),l=k(N,"DIV",{class:!0});var $=T(l);t=k($,"HEADER",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-129wqqj"&&(t.innerHTML=n),r=S($),o=k($,"MAIN",{class:!0});var I=T(o);te(a.$$.fragment,I),i=S(I),h=k(I,"DIV",{class:!0});var B=T(h);te(c.$$.fragment,B),B.forEach(v),f=S(I),p&&p.l(I),g=S(I),y&&y.l(I),u=S(I),C&&C.l(I),I.forEach(v),R=S($),E=k($,"FOOTER",{class:!0,"data-svelte-h":!0}),z(E)!=="svelte-1h3pyfb"&&(E.innerHTML=D),$.forEach(v),this.h()},h(){document.title="Nonogram Editor",_(t,"class","svelte-1d5q74c"),_(h,"class","controls-bar svelte-1d5q74c"),_(o,"class","svelte-1d5q74c"),_(E,"class","svelte-1d5q74c"),_(l,"class","app-container svelte-1d5q74c")},m(N,q){L(N,e,q),L(N,l,q),m(l,t),m(l,r),m(l,o),le(a,o,null),m(o,i),m(o,h),le(c,h,null),m(o,f),p&&p.m(o,null),m(o,g),y&&y.m(o,null),m(o,u),~w&&P[w].m(o,null),m(l,R),m(l,E),d=!0},p(N,[q]){var B;const $={};q&1&&($.currentNonogramName=((B=N[0])==null?void 0:B.name)||""),a.$set($),N[2]==="create"&&!N[1].length?p?p.p(N,q):(p=Ye(N),p.c(),p.m(o,g)):p&&(p.d(1),p=null),(N[2]==="edit"||N[2]==="create"&&N[1].length>0)&&N[4]?y?y.p(N,q):(y=Qe(N),y.c(),y.m(o,u)):y&&(y.d(1),y=null);let I=w;w=A(N),w===I?~w&&P[w].p(N,q):(C&&(xe(),F(P[I],1,1,()=>{P[I]=null}),Ze()),~w?(C=P[w],C?C.p(N,q):(C=P[w]=V[w](N),C.c()),K(C,1),C.m(o,null)):C=null)},i(N){d||(K(a.$$.fragment,N),K(c.$$.fragment,N),K(C),d=!0)},o(N){F(a.$$.fragment,N),F(c.$$.fragment,N),F(C),d=!1},d(N){N&&(v(e),v(l)),ne(a),ne(c),p&&p.d(),y&&y.d(),~w&&P[w].d()}}}function jt(s,e,l){let t,n,r,o,a,i,h,c;ae.subscribe(D=>l(0,n=D)),ke.subscribe(D=>l(1,r=D)),ve.subscribe(D=>l(3,o=D)),x.subscribe(D=>l(2,a=D)),re.subscribe(D=>l(4,i=D)),ut.subscribe(D=>l(5,h=D)),ft.subscribe(D=>l(6,c=D)),Xe(()=>{const D=d=>{if(i)return d.preventDefault(),d.returnValue="",""};return window.addEventListener("beforeunload",D),()=>{window.removeEventListener("beforeunload",D)}});async function f(D){const d=D.detail;if(!(i&&!window.confirm("You have unsaved changes. Are you sure you want to load a different nonogram?")))try{x.set("loading"),j.set(`Loading ${d}...`);const p=await at(d);ae.set(p),ht(p),x.set("play"),re.set(!1),j.set(`Loaded ${d} successfully.`),setTimeout(()=>j.set(""),2e3)}catch(p){console.error(`Error loading nonogram "${d}":`,p),j.set(`Error loading ${d}. Please try again.`),x.set("view")}}function g(){i&&!window.confirm("You have unsaved changes. Are you sure you want to create a new nonogram?")||(x.set("create"),re.set(!1),ae.set(null))}function u(D){const{row:d,col:p,isRightClick:y}=D.detail;a==="play"?gt(d,p,y):(a==="edit"||a==="create")&&mt(d,p)}async function w(){if(h<3||h>20||c<3||c>20){alert("Grid dimensions must be between 3 and 20");return}_t(h,c),re.set(!0)}async function C(){try{if(j.set("Processing..."),a==="create"||a==="edit"){const D=Te(r),p={name:(n==null?void 0:n.name)||"New Nonogram",board:r},y=await ct(p);ae.set(y),re.set(!1),j.set("Nonogram processed successfully! (Note: Not saved to backend in v1.0)"),setTimeout(()=>j.set(""),3e3)}}catch(D){console.error("Error saving nonogram:",D),j.set("Error processing nonogram. Please try again.")}}function R(){h=ge(this.value),l(5,h)}function E(){c=ge(this.value),l(6,c)}return s.$$.update=()=>{s.$$.dirty&7&&l(7,t=a==="edit"||a==="create"?Te(r):(n==null?void 0:n.descriptors)||{rows:[],columns:[]})},[n,r,a,o,i,h,c,t,f,g,u,w,C,R,E]}class Kt extends ue{constructor(e){super(),fe(this,e,jt,zt,ie,{})}}export{Kt as component};
